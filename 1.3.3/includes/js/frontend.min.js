function gravityformsqualpay(a,r,e){if(window.gf_cc_rules||(window.gf_cc_rules=gfp_qualpay_frontend_strings.credit_card_rules),r===parseInt(gfp_qualpay_frontend_strings.formId)&&(!gfp_qualpay_frontend_strings.hasPages||e===gfp_qualpay_frontend_strings.pageCount)){if(gformQualpayIsPostback(r)&&gformQualpayHasError(r)){qpEmbeddedForm.unloadFrame();var o={action:"gaddon_qualpay_transient_key",gaddon_qualpay_transient_key:gfp_qualpay_frontend_strings.transient_key_nonce,form_id:r};jQuery.post(gfp_qualpay_frontend_strings.ajaxurl,o).done(function(a){!0===a.success&&(gfp_qualpay_frontend_strings.transientKey=a.data,gravityformsqualpay_load_frame())})}else gravityformsqualpay_load_frame()}}function gravityformsqualpay_load_frame(){var a=jQuery("#achOnOff").val(),r=!1;(1==a||""==a)&&(r=!0),qpEmbeddedForm.loadFrame(gfp_qualpay_frontend_strings.merchant_id,{formId:gfp_qualpay_frontend_strings.form_element_id,mode:gfp_qualpay_frontend_strings.mode,transientKey:gfp_qualpay_frontend_strings.transientKey,tokenize:!0,onSuccess:gravityformsqualpay_success,onError:gravityformsqualpay_error,achConfig:{enabled:r}})}function gravityformsqualpay_success(a){var r=a.card_id,e=a.card_number,o=a.card_type,n=a.type_id,i=gfp_qualpay_frontend_strings.formId,t=jQuery("#gform_"+i),f=gfp_qualpay_frontend_strings.creditcard_field_id;e.slice(0,5),e.substr(e.length-4),t.find(gfp_qualpay_frontend_strings.responseField).val(r),t.find("#input_"+i+"_"+f+"_1").val(parseInt(e)),t.find("#input_"+i+"_"+f+"_11").val(e),t.find("#input_"+i+"_"+f+"_4").val({AM:"Amex",DS:"Discover",PP:"PayPal",MC:"MasterCard",VS:"Visa",AP:"ACH"}[o]),t.find("#input_"+i+"_"+f+"_5").val(n),t.submit()}function gravityformsqualpay_error(a){var r=jQuery("#gform_"+gfp_qualpay_frontend_strings.formId);if(a.detail){var e="";for(let o in a.detail)e+=a.detail[o];r.find(gfp_qualpay_frontend_strings.errorField).val(e)}r.submit()}function gformQualpayIsPostback(a){var r=!1,e=jQuery("#gform_ajax_frame_"+a).contents().find("*").html();return void 0!==e&&(r=0<e.indexOf("GF_AJAX_POSTBACK")),r}function gformQualpayHasError(a){return jQuery("#gform_confirmation_wrapper_"+a).hasClass("gform_validation_error")||jQuery("#gform_ajax_frame_"+a).contents().find("#gform_wrapper_"+a).hasClass("gform_validation_error")}jQuery(document).on("gform_post_render",gravityformsqualpay);function gravityformsqualpay(a,r,e){if(window.gf_cc_rules||(window.gf_cc_rules=gfp_qualpay_frontend_strings.credit_card_rules),r===parseInt(gfp_qualpay_frontend_strings.formId)&&(!gfp_qualpay_frontend_strings.hasPages||e===gfp_qualpay_frontend_strings.pageCount)){if(gformQualpayIsPostback(r)&&gformQualpayHasError(r)){qpEmbeddedForm.unloadFrame();var o={action:"gaddon_qualpay_transient_key",gaddon_qualpay_transient_key:gfp_qualpay_frontend_strings.transient_key_nonce,form_id:r};jQuery.post(gfp_qualpay_frontend_strings.ajaxurl,o).done(function(a){!0===a.success&&(gfp_qualpay_frontend_strings.transientKey=a.data,gravityformsqualpay_load_frame())})}else gravityformsqualpay_load_frame()}}function gravityformsqualpay_load_frame(){var a=jQuery("#achOnOff").val(),r=!1;(1==a||""==a)&&(r=!0),qpEmbeddedForm.loadFrame(gfp_qualpay_frontend_strings.merchant_id,{formId:gfp_qualpay_frontend_strings.form_element_id,mode:gfp_qualpay_frontend_strings.mode,transientKey:gfp_qualpay_frontend_strings.transientKey,tokenize:!0,onSuccess:gravityformsqualpay_success,onError:gravityformsqualpay_error,achConfig:{enabled:r}})}function gravityformsqualpay_success(a){var r=a.card_id,e=a.card_number,o=a.card_type,n=a.type_id,i=gfp_qualpay_frontend_strings.formId,t=jQuery("#gform_"+i),f=gfp_qualpay_frontend_strings.creditcard_field_id;e.slice(0,5),e.substr(e.length-4),t.find(gfp_qualpay_frontend_strings.responseField).val(r),t.find("#input_"+i+"_"+f+"_1").val(parseInt(e)),t.find("#input_"+i+"_"+f+"_11").val(e),t.find("#input_"+i+"_"+f+"_4").val({AM:"Amex",DS:"Discover",PP:"PayPal",MC:"MasterCard",VS:"Visa",AP:"ACH"}[o]),t.find("#input_"+i+"_"+f+"_5").val(n),t.submit()}function gravityformsqualpay_error(a){var r=jQuery("#gform_"+gfp_qualpay_frontend_strings.formId);if(a.detail){var e="";for(let o in a.detail)e+=a.detail[o];r.find(gfp_qualpay_frontend_strings.errorField).val(e)}r.submit()}function gformQualpayIsPostback(a){var r=!1,e=jQuery("#gform_ajax_frame_"+a).contents().find("*").html();return void 0!==e&&(r=0<e.indexOf("GF_AJAX_POSTBACK")),r}function gformQualpayHasError(a){return jQuery("#gform_confirmation_wrapper_"+a).hasClass("gform_validation_error")||jQuery("#gform_ajax_frame_"+a).contents().find("#gform_wrapper_"+a).hasClass("gform_validation_error")}jQuery(document).on("gform_post_render",gravityformsqualpay);